<!doctype html>
<html lang="tr">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Forum - YTConsole</title>
  <link rel="icon" href="../favicon.svg" type="image/svg+xml" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="../styles.css" />
  <link rel="stylesheet" href="forum.css" />
</head>

<body>
  <!-- ═══ HEADER ═══ -->
  <header class="header">
    <div class="forum-container header-inner">
      <a href="../index.html" class="brand">
        <div class="logo">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
            <path d="M23.5 6.2a3 3 0 0 0-2.1-2.1C19.5 3.5 12 3.5 12 3.5s-7.5 0-9.4.6A3 3 0 0 0 .5 6.2 31.4 31.4 0 0 0 0 12a31.4 31.4 0 0 0 .5 5.8 3 3 0 0 0 2.1 2.1c1.9.6 9.4.6 9.4.6s7.5 0 9.4-.6a3 3 0 0 0 2.1-2.1A31.4 31.4 0 0 0 24 12a31.4 31.4 0 0 0-.5-5.8z" fill="#fff"/>
            <path d="M9.6 15.6V8.4l6.4 3.6-6.4 3.6z" fill="#6B1D2A"/>
          </svg>
        </div>
        <div>
          <div class="brand-title">Forum</div>
          <div class="brand-sub">YTConsole</div>
        </div>
      </a>
      <div class="header-actions">
        <a href="../index.html" class="btn-secondary mini">Ana Sayfa</a>

        <!-- Auth -->
        <div class="auth-actions" id="authActions">
          <div class="auth-guest" id="authGuest">
            <button class="btn-text" id="loginBtn" type="button">Giris Yap</button>
            <button class="btn-primary small" id="registerBtn" type="button">Kayit Ol</button>
          </div>
          <div class="auth-user" id="authUser" style="display:none;">
            <div class="token-balance" id="headerTokenBalance">
              <span class="token-icon">
                <svg width="24" height="24" viewBox="0 0 64 64" fill="none">
                  <circle cx="32" cy="32" r="30" fill="#FFB300"/>
                  <circle cx="32" cy="32" r="24" fill="#FFCA28"/>
                  <path d="M48 14L52 18" stroke="white" stroke-width="4" stroke-linecap="round" opacity="0.6"/>
                  <path d="M32 18V46M38 26H35C33 26 32 27 32 29V31C32 33 33 34 35 34H38V42H26V34H29C31 34 32 33 32 31V29C32 27 31 26 29 26H26" stroke="#F57F17" stroke-width="5" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
              </span>
              <span id="userTokens">0</span>
            </div>
            <div class="user-avatar" id="userProfileBtn" title="Profil">
              <span id="userInitials">U</span>
            </div>
            <div class="user-dropdown" id="userDropdown">
              <div class="dropdown-header">
                <strong id="dropdownName">Kullanici</strong>
                <span id="dropdownEmail">user@example.com</span>
              </div>
              <div class="dropdown-divider"></div>
              <button class="dropdown-item text-danger" id="logoutBtn">
                <span>Cikis Yap</span>
              </button>
            </div>
          </div>
        </div>

        <button class="btn-icon" id="themeToggle" type="button" title="Tema Degistir">
          <svg class="icon-moon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
          </svg>
          <svg class="icon-sun" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display:none">
            <circle cx="12" cy="12" r="5"/>
            <line x1="12" y1="1" x2="12" y2="3"/>
            <line x1="12" y1="21" x2="12" y2="23"/>
            <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/>
            <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/>
            <line x1="1" y1="12" x2="3" y2="12"/>
            <line x1="21" y1="12" x2="23" y2="12"/>
            <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/>
            <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/>
          </svg>
        </button>
      </div>
    </div>
  </header>

  <!-- ═══ MAIN CONTENT ═══ -->
  <main class="forum-container" style="padding: 0 0 40px;">

    <!-- ── Toolbar ── -->
    <div class="forum-toolbar">
      <div class="forum-search">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="11" cy="11" r="8"/>
          <line x1="21" y1="21" x2="16.65" y2="16.65"/>
        </svg>
        <input type="text" id="forumSearchInput" placeholder="Konularda ara..." class="search-input">
      </div>
      <div class="forum-toolbar-right">
        <!-- Notification Bell -->
        <div style="position:relative;" id="notifWrap">
          <button class="notif-btn" id="notifBtn" type="button" title="Bildirimler">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"/>
              <path d="M13.73 21a2 2 0 0 1-3.46 0"/>
            </svg>
            <span class="notif-badge" id="notifCount" style="display:none;">0</span>
          </button>
          <div class="notif-dropdown" id="notifDropdown">
            <div class="notif-dropdown-header">
              <span>Bildirimler</span>
              <button class="btn-text" id="notifReadAll" style="font-size:12px;padding:4px;">Tumunu Oku</button>
            </div>
            <div id="notifList">
              <div class="notif-empty">Bildirim yok</div>
            </div>
          </div>
        </div>

        <!-- Admin Button (hidden by default) -->
        <button class="btn-admin" id="adminPanelBtn" type="button" style="display:none;">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="12" cy="12" r="3"/>
            <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/>
          </svg>
          Admin Paneli
        </button>

        <!-- New Thread -->
        <button class="btn-new-thread" id="newThreadBtn" type="button" style="display:none;">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <line x1="12" y1="5" x2="12" y2="19"/>
            <line x1="5" y1="12" x2="19" y2="12"/>
          </svg>
          Yeni Konu
        </button>
      </div>
    </div>

    <!-- ═══ VIEW 1: HOME ═══ -->
    <div class="forum-view is-active" id="viewHome">

      <!-- Tabs -->
      <div class="forum-tabs">
        <button class="forum-tab is-active" data-tab="recent">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/></svg>
          Son Acilan
        </button>
        <button class="forum-tab" data-tab="popular">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>
          Populer
        </button>
      </div>

      <!-- Recent threads list -->
      <div class="forum-recent" id="recentThreadsArea">
        <div class="forum-recent-header">
          <span>Konu Basligi</span>
          <span>Son Cevap</span>
          <span style="text-align:right;">Kategori</span>
        </div>
        <div id="recentThreadsList">
          <div class="forum-loading"><div class="spinner"></div>Yukleniyor...</div>
        </div>
      </div>
      <button class="forum-load-more" id="loadMoreBtn" style="display:none;">Daha Fazla Icerik Goster</button>

      <!-- Category Groups -->
      <div class="forum-groups" id="categoryGroupsArea">
        <div class="forum-groups-header">
          <span>FORUM</span>
          <span>Son Mesaj</span>
          <span style="text-align:right;">Konu / Mesaj</span>
        </div>
        <div id="categoryGroupsList">
          <div class="forum-loading"><div class="spinner"></div>Yukleniyor...</div>
        </div>
      </div>
    </div>

    <!-- ═══ VIEW 2: CATEGORY ═══ -->
    <div class="forum-view" id="viewCategory">
      <div class="view-header">
        <div class="breadcrumb" id="categoryBreadcrumb"></div>
        <div class="category-title-bar">
          <h2 id="categoryViewTitle">Kategori</h2>
          <button class="btn-new-thread" id="newThreadBtnCat" type="button" style="display:none;">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <line x1="12" y1="5" x2="12" y2="19"/>
              <line x1="5" y1="12" x2="19" y2="12"/>
            </svg>
            Yeni Konu
          </button>
        </div>
      </div>

      <div class="thread-list" id="threadListArea">
        <div class="thread-list-header">
          <span>Konu</span>
          <span style="text-align:center;">Cevap</span>
          <span style="text-align:center;">Gorus</span>
          <span style="text-align:center;">Son Cevap</span>
        </div>
        <div id="threadListContent">
          <div class="forum-loading"><div class="spinner"></div>Yukleniyor...</div>
        </div>
      </div>
      <div class="pagination" id="threadPagination"></div>
    </div>

    <!-- ═══ VIEW 3: THREAD DETAIL ═══ -->
    <div class="forum-view" id="viewThread">
      <div class="view-header">
        <div class="breadcrumb" id="threadBreadcrumb"></div>
      </div>
      <div class="thread-detail" id="threadDetailArea">
        <div class="forum-loading"><div class="spinner"></div>Yukleniyor...</div>
      </div>
    </div>

    <!-- ═══ VIEW 4: ADMIN PANEL ═══ -->
    <div class="forum-view" id="viewAdmin">
      <div class="view-header">
        <div class="breadcrumb">
          <a onclick="Forum.navigate('home')">Forum</a>
          <span class="sep">></span>
          <span>Admin Paneli</span>
        </div>
      </div>

      <div class="admin-panel">
        <div class="admin-tabs">
          <button class="admin-tab is-active" data-admin-tab="groups">Kategori Gruplari</button>
          <button class="admin-tab" data-admin-tab="categories">Kategoriler</button>
          <button class="admin-tab" data-admin-tab="users">Kullanicilar</button>
        </div>

        <div class="admin-content" id="adminContent">
          <!-- Dynamic content loaded by JS -->
        </div>
      </div>
    </div>
  </main>

  <!-- ═══ FOOTER ═══ -->
  <footer class="forum-container footer">
    <div class="footer-left">
      <span>YTConsole &copy; 2026</span>
    </div>
  </footer>

  <!-- Toast -->
  <div class="toast" id="toast" role="status" aria-live="polite"></div>

  <!-- ═══ MODAL OVERLAY ═══ -->
  <div class="forum-modal-overlay" id="forumModalOverlay"></div>

  <!-- ═══ NEW THREAD MODAL ═══ -->
  <div class="forum-modal" id="newThreadModal">
    <div class="forum-modal-header">
      <span class="forum-modal-title">Yeni Konu Ac</span>
      <button class="forum-modal-close" id="newThreadClose">&times;</button>
    </div>
    <form id="newThreadForm">
      <div class="field">
        <span class="label">Kategori</span>
        <select id="threadCategorySelect" required>
          <option value="">Kategori sec...</option>
        </select>
      </div>
      <div class="field">
        <span class="label">Alt Kategori (Opsiyonel)</span>
        <select id="threadSubcategorySelect">
          <option value="">Yok</option>
        </select>
      </div>
      <div class="field">
        <span class="label">Baslik</span>
        <input type="text" id="threadTitleInput" required placeholder="Konu basligini yazin..." maxlength="200">
      </div>
      <div class="field">
        <span class="label">Icerik</span>
        <textarea id="threadContentInput" required placeholder="Konunuzu detayli aciklayin..." style="min-height:150px;"></textarea>
      </div>
      <div class="field">
        <span class="label">Etiketler (virgul ile ayirin)</span>
        <input type="text" id="threadTagsInput" placeholder="ornek: seo, youtube, ipucu">
      </div>
      <div style="display:flex;justify-content:flex-end;gap:8px;margin-top:8px;">
        <button type="button" class="btn-secondary" onclick="ForumModals.close()">Iptal</button>
        <button type="submit" class="btn-primary" id="threadSubmitBtn">Konuyu Ac</button>
      </div>
    </form>
  </div>

  <!-- ═══ LOGIN MODAL ═══ -->
  <div class="forum-modal" id="loginModal">
    <div class="forum-modal-header">
      <span class="forum-modal-title">Giris Yap</span>
      <button class="forum-modal-close" onclick="ForumModals.close()">&times;</button>
    </div>
    <form id="loginForm">
      <div class="field">
        <span class="label">E-posta</span>
        <input type="email" id="loginEmail" required placeholder="ornek@email.com">
      </div>
      <div class="field">
        <span class="label">Sifre</span>
        <input type="password" id="loginPassword" required placeholder="******">
      </div>
      <button class="btn-primary full-width" type="submit" id="loginSubmitBtn" style="margin-top:8px;">Giris Yap</button>
    </form>
    <div class="modal-footer-text" style="margin-top:16px;">
      Hesabin yok mu? <a href="#" id="swToRegister">Kayit Ol</a>
    </div>
  </div>

  <!-- ═══ REGISTER MODAL ═══ -->
  <div class="forum-modal" id="registerModal">
    <div class="forum-modal-header">
      <span class="forum-modal-title">Kayit Ol</span>
      <button class="forum-modal-close" onclick="ForumModals.close()">&times;</button>
    </div>
    <form id="registerForm">
      <div class="field">
        <span class="label">Ad Soyad</span>
        <input type="text" id="regName" required placeholder="Adiniz">
      </div>
      <div class="field">
        <span class="label">E-posta</span>
        <input type="email" id="regEmail" required placeholder="ornek@email.com">
      </div>
      <div class="field">
        <span class="label">Sifre</span>
        <input type="password" id="regPassword" required minlength="6" placeholder="******">
      </div>
      <button class="btn-primary full-width" type="submit" id="regSubmitBtn" style="margin-top:8px;">Hesap Olustur</button>
    </form>
    <div class="modal-footer-text" style="margin-top:16px;">
      Zaten uye misin? <a href="#" id="swToLogin">Giris Yap</a>
    </div>
  </div>

  <!-- ═══ ADMIN EDIT MODAL ═══ -->
  <div class="forum-modal" id="adminEditModal">
    <div class="forum-modal-header">
      <span class="forum-modal-title" id="adminEditTitle">Duzenle</span>
      <button class="forum-modal-close" onclick="ForumModals.close()">&times;</button>
    </div>
    <form id="adminEditForm">
      <div class="field">
        <span class="label" id="adminEditLabel1">Ad</span>
        <input type="text" id="adminEditInput1" required>
      </div>
      <div class="field" id="adminEditField2" style="display:none;">
        <span class="label" id="adminEditLabel2">Aciklama</span>
        <textarea id="adminEditInput2"></textarea>
      </div>
      <div class="field" id="adminEditField3" style="display:none;">
        <span class="label" id="adminEditLabel3">Ikon</span>
        <input type="text" id="adminEditInput3">
      </div>
      <div style="display:flex;justify-content:flex-end;gap:8px;margin-top:8px;">
        <button type="button" class="btn-secondary" onclick="ForumModals.close()">Iptal</button>
        <button type="submit" class="btn-primary" id="adminEditSubmit">Kaydet</button>
      </div>
    </form>
  </div>

  <!-- Profile Popover -->
  <div class="profile-popover" id="profilePopover">
    <div class="profile-popover-header">
      <div class="profile-popover-avatar" id="popoverAvatar">U</div>
      <div class="profile-popover-info">
        <div class="profile-popover-name" id="popoverName">Kullanici</div>
        <div class="role-badge user" id="popoverRole">Kullanici</div>
      </div>
    </div>
    <div class="profile-popover-stats">
      <div class="profile-popover-stat">
        <div class="stat-value" id="popoverThreads">0</div>
        <div class="stat-label">Konu</div>
      </div>
      <div class="profile-popover-stat">
        <div class="stat-value" id="popoverReplies">0</div>
        <div class="stat-label">Mesaj</div>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.min.js"></script>
  <script src="forum.js"></script>
</body>

</html>
